# æç©ºé—´è™šæ‹Ÿæœºéƒ¨ç½²æŒ‡å—

ä½¿ç”¨æç©ºé—´è™šæ‹Ÿæœºè¿è¡ŒWebæœåŠ¡å™¨ï¼Œæä¾›æ›´å¥½çš„æ€§èƒ½å’Œå®Œæ•´åŠŸèƒ½æ”¯æŒã€‚

## ğŸ¯ ä¸ºä»€ä¹ˆä½¿ç”¨è™šæ‹Ÿæœºï¼Ÿ

### ä¼˜åŠ¿
- âœ… **å®Œæ•´æ“ä½œç³»ç»Ÿ**ï¼šå¯ä»¥å®‰è£…ä»»ä½•WebæœåŠ¡å™¨
- âœ… **æ›´å¥½æ€§èƒ½**ï¼šç‹¬ç«‹èµ„æºï¼Œä¸å—NASç³»ç»Ÿé™åˆ¶
- âœ… **å®Œæ•´åŠŸèƒ½**ï¼šæ”¯æŒHTTPSã€åŸŸåã€SSLè¯ä¹¦ç­‰
- âœ… **æ˜“äºç®¡ç†**ï¼šå¯ä»¥SSHç™»å½•ï¼Œä½¿ç”¨å‘½ä»¤è¡Œç®¡ç†
- âœ… **çµæ´»é…ç½®**ï¼šå¯ä»¥å®‰è£…Nginxã€Apacheç­‰ä»»æ„WebæœåŠ¡å™¨

### é€‚ç”¨åœºæ™¯
- éœ€è¦HTTPSæ”¯æŒï¼ˆPWAå¿…éœ€ï¼‰
- éœ€è¦å›ºå®šåŸŸåè®¿é—®
- éœ€è¦æ›´å¥½çš„æ€§èƒ½
- éœ€è¦æ›´å¤šè‡ªå®šä¹‰é…ç½®

---

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. ç¡®è®¤æç©ºé—´è™šæ‹ŸæœºåŠŸèƒ½

- âœ… æç©ºé—´NASæ”¯æŒè™šæ‹ŸæœºåŠŸèƒ½
- âœ… å·²åˆ›å»ºå¹¶å¯åŠ¨è™šæ‹Ÿæœº
- âœ… è™šæ‹Ÿæœºå¯ä»¥è®¿é—®ç½‘ç»œ
- âœ… å¯ä»¥SSHç™»å½•è™šæ‹Ÿæœºï¼ˆæˆ–ä½¿ç”¨VNCï¼‰

### 2. é€‰æ‹©è™šæ‹Ÿæœºç³»ç»Ÿ

**æ¨èç³»ç»Ÿï¼š**
- **Ubuntu Server 22.04 LTS**ï¼ˆæ¨èï¼Œè½»é‡çº§ï¼‰
- **Debian**ï¼ˆç¨³å®šï¼Œèµ„æºå ç”¨å°‘ï¼‰
- **CentOS Stream**ï¼ˆä¼ä¸šçº§ï¼‰
- **Alpine Linux**ï¼ˆæœ€è½»é‡ï¼Œä½†é…ç½®ç¨å¤æ‚ï¼‰

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨Nginxï¼ˆæ¨èï¼‰

#### æ­¥éª¤1ï¼šåœ¨è™šæ‹Ÿæœºä¸­å®‰è£…Nginx

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install nginx -y

# å¯åŠ¨Nginx
sudo systemctl start nginx
sudo systemctl enable nginx

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status nginx
```

#### æ­¥éª¤2ï¼šä¸Šä¼ æ–‡ä»¶åˆ°è™šæ‹Ÿæœº

**æ–¹æ³•Aï¼šé€šè¿‡SMBå…±äº«**

1. åœ¨è™šæ‹Ÿæœºä¸­å®‰è£…SMBå®¢æˆ·ç«¯æˆ–é…ç½®å…±äº«
2. ä»NASå…±äº«æ–‡ä»¶å¤¹å¤åˆ¶æ–‡ä»¶åˆ°è™šæ‹Ÿæœº

**æ–¹æ³•Bï¼šé€šè¿‡SCP/SFTP**

```bash
# ä»æœ¬åœ°ç”µè„‘ä¸Šä¼ åˆ°è™šæ‹Ÿæœº
scp -r study/ ç”¨æˆ·å@è™šæ‹ŸæœºIP:/var/www/html/

# æˆ–ä½¿ç”¨SFTPå®¢æˆ·ç«¯ï¼ˆå¦‚FileZillaï¼‰
```

**æ–¹æ³•Cï¼šé€šè¿‡Gitï¼ˆå¦‚æœæœ‰ï¼‰**

```bash
# åœ¨è™šæ‹Ÿæœºä¸­
cd /var/www/html
git clone [æ‚¨çš„ä»“åº“åœ°å€]
```

#### æ­¥éª¤3ï¼šé…ç½®Nginx

åˆ›å»ºNginxé…ç½®æ–‡ä»¶ï¼š

```bash
sudo nano /etc/nginx/sites-available/study-games
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```nginx
server {
    listen 80;
    server_name _;  # æˆ–æ‚¨çš„åŸŸå
    
    root /var/www/html/study;
    index index.html;
    
    # æ¸¸æˆåˆ—è¡¨
    location = / {
        try_files /index.html =404;
    }
    
    # èˆ’å°”ç‰¹æ–¹æ ¼æ¸¸æˆ
    location /schulte-grid/ {
        try_files $uri $uri/ /schulte-grid/index.html;
        
        # Service Workeræ”¯æŒ
        location ~ /schulte-grid/service-worker\.js$ {
            add_header Cache-Control "no-cache, no-store, must-revalidate";
        }
    }
    
    # é€šç”¨æ¸¸æˆè·¯å¾„ï¼ˆè‡ªåŠ¨æ”¯æŒæ–°æ¸¸æˆï¼‰
    location ~ ^/([^/]+)/ {
        set $game_dir $1;
        try_files $uri $uri/ /$game_dir/index.html;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
}
```

å¯ç”¨é…ç½®ï¼š

```bash
# åˆ›å»ºç¬¦å·é“¾æ¥
sudo ln -s /etc/nginx/sites-available/study-games /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡æ–°åŠ è½½Nginx
sudo systemctl reload nginx
```

#### æ­¥éª¤4ï¼šè®¾ç½®æ–‡ä»¶æƒé™

```bash
# è®¾ç½®æ–‡ä»¶æ‰€æœ‰è€…
sudo chown -R www-data:www-data /var/www/html/study

# è®¾ç½®æ–‡ä»¶æƒé™
sudo chmod -R 755 /var/www/html/study
```

#### æ­¥éª¤5ï¼šè®¿é—®åº”ç”¨

- **å†…ç½‘è®¿é—®**ï¼š`http://è™šæ‹ŸæœºIPåœ°å€/`
- **æ¸¸æˆåˆ—è¡¨**ï¼š`http://è™šæ‹ŸæœºIPåœ°å€/`
- **èˆ’å°”ç‰¹æ–¹æ ¼**ï¼š`http://è™šæ‹ŸæœºIPåœ°å€/schulte-grid/`

---

### æ–¹æ³•äºŒï¼šä½¿ç”¨Apache

#### æ­¥éª¤1ï¼šå®‰è£…Apache

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install apache2 -y

# å¯åŠ¨Apache
sudo systemctl start apache2
sudo systemctl enable apache2
```

#### æ­¥éª¤2ï¼šé…ç½®Apache

åˆ›å»ºè™šæ‹Ÿä¸»æœºé…ç½®ï¼š

```bash
sudo nano /etc/apache2/sites-available/study-games.conf
```

æ·»åŠ å†…å®¹ï¼š

```apache
<VirtualHost *:80>
    ServerName _
    DocumentRoot /var/www/html/study
    
    <Directory /var/www/html/study>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # å¯ç”¨é‡å†™è§„åˆ™
    <Directory /var/www/html/study>
        RewriteEngine On
        RewriteBase /
        RewriteRule ^schulte-grid/$ /schulte-grid/index.html [L]
    </Directory>
</VirtualHost>
```

å¯ç”¨é…ç½®ï¼š

```bash
# å¯ç”¨æ¨¡å—
sudo a2enmod rewrite
sudo a2enmod headers

# å¯ç”¨ç«™ç‚¹
sudo a2ensite study-games

# é‡æ–°åŠ è½½Apache
sudo systemctl reload apache2
```

---

## ğŸ”’ é…ç½®HTTPSï¼ˆé‡è¦ï¼‰

### ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦

#### æ­¥éª¤1ï¼šå®‰è£…Certbot

```bash
# Ubuntu/Debian
sudo apt install certbot python3-certbot-nginx -y
```

#### æ­¥éª¤2ï¼šè·å–è¯ä¹¦

```bash
# å¦‚æœæœ‰åŸŸå
sudo certbot --nginx -d yourdomain.com

# æˆ–äº¤äº’å¼é…ç½®
sudo certbot --nginx
```

#### æ­¥éª¤3ï¼šè‡ªåŠ¨ç»­æœŸ

```bash
# æµ‹è¯•ç»­æœŸ
sudo certbot renew --dry-run

# Certbotä¼šè‡ªåŠ¨é…ç½®cronä»»åŠ¡
```

### ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼ˆä»…å†…ç½‘ä½¿ç”¨ï¼‰

```bash
# ç”Ÿæˆè‡ªç­¾åè¯ä¹¦
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/study-selfsigned.key \
  -out /etc/ssl/certs/study-selfsigned.crt

# é…ç½®Nginxä½¿ç”¨è¯ä¹¦
# ç¼–è¾‘ /etc/nginx/sites-available/study-games
# æ·»åŠ SSLé…ç½®
```

---

## ğŸŒ é…ç½®åŸŸåè®¿é—®ï¼ˆå¯é€‰ï¼‰

### æ–¹æ³•1ï¼šä½¿ç”¨æç©ºé—´DDNS

1. åœ¨æç©ºé—´ç®¡ç†ç•Œé¢é…ç½®DDNS
2. è®¾ç½®ç«¯å£è½¬å‘ï¼ˆå¦‚80â†’è™šæ‹ŸæœºIP:80ï¼‰
3. é€šè¿‡åŸŸåè®¿é—®

### æ–¹æ³•2ï¼šä½¿ç”¨Cloudflare Tunnelï¼ˆæ¨èï¼Œå…è´¹ï¼‰

1. **åœ¨è™šæ‹Ÿæœºä¸­å®‰è£…cloudflared**

```bash
# Ubuntu/Debian
wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
sudo dpkg -i cloudflared-linux-amd64.deb
```

2. **é…ç½®éš§é“**

```bash
# ç™»å½•Cloudflare
cloudflared tunnel login

# åˆ›å»ºéš§é“
cloudflared tunnel create study-games

# é…ç½®éš§é“
cloudflared tunnel route dns study-games yourdomain.com
```

3. **è¿è¡Œéš§é“**

```bash
cloudflared tunnel run study-games
```

---

## ğŸ“± åœ¨iPadä¸Šå®‰è£…

### æ­¥éª¤1ï¼šè®¿é—®åº”ç”¨

1. åœ¨iPad Safariä¸­æ‰“å¼€ï¼š
   - `https://æ‚¨çš„åŸŸå/`ï¼ˆå¦‚æœé…ç½®äº†åŸŸåï¼‰
   - æˆ– `https://è™šæ‹ŸæœºIP/`ï¼ˆå¦‚æœé…ç½®äº†HTTPSï¼‰

2. **ç¡®è®¤HTTPSæœ‰æ•ˆ**
   - åœ°å€æ æ˜¾ç¤ºğŸ”’é”å›¾æ ‡

### æ­¥éª¤2ï¼šæ·»åŠ åˆ°ä¸»å±å¹•

1. ç‚¹å‡»Safariåº•éƒ¨çš„"åˆ†äº«"æŒ‰é’®
2. é€‰æ‹©"æ·»åŠ åˆ°ä¸»å±å¹•"
3. å®Œæˆå®‰è£…

---

## ğŸ”§ é«˜çº§é…ç½®

### 1. æ€§èƒ½ä¼˜åŒ–

```nginx
# åœ¨nginx.confä¸­æ·»åŠ 
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_types text/plain text/css application/json application/javascript;

# å¯ç”¨ç¼“å­˜
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m;
```

### 2. å®‰å…¨åŠ å›º

```nginx
# éšè—Nginxç‰ˆæœ¬
server_tokens off;

# é™åˆ¶è¯·æ±‚å¤§å°
client_max_body_size 10M;

# é˜²æ­¢ç‚¹å‡»åŠ«æŒ
add_header X-Frame-Options "SAMEORIGIN" always;
```

### 3. æ—¥å¿—é…ç½®

```nginx
access_log /var/log/nginx/study-access.log;
error_log /var/log/nginx/study-error.log;
```

---

## ğŸ“Š èµ„æºéœ€æ±‚

### æœ€å°é…ç½®
- **CPU**ï¼š1æ ¸å¿ƒ
- **å†…å­˜**ï¼š512MB
- **å­˜å‚¨**ï¼š2GB
- **ç³»ç»Ÿ**ï¼šUbuntu Server 22.04

### æ¨èé…ç½®
- **CPU**ï¼š2æ ¸å¿ƒ
- **å†…å­˜**ï¼š1GB
- **å­˜å‚¨**ï¼š5GB
- **ç³»ç»Ÿ**ï¼šUbuntu Server 22.04 LTS

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ— æ³•è®¿é—®è™šæ‹Ÿæœºï¼Ÿ

**æ£€æŸ¥ï¼š**
- è™šæ‹Ÿæœºç½‘ç»œé…ç½®ï¼ˆæ¡¥æ¥æ¨¡å¼æˆ–NATï¼‰
- é˜²ç«å¢™è§„åˆ™
- ç«¯å£æ˜¯å¦å¼€æ”¾

### Q2: Nginxæ— æ³•å¯åŠ¨ï¼Ÿ

**æ£€æŸ¥ï¼š**
- é…ç½®æ–‡ä»¶è¯­æ³•ï¼š`sudo nginx -t`
- ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š`sudo netstat -tulpn | grep :80`
- æŸ¥çœ‹æ—¥å¿—ï¼š`sudo tail -f /var/log/nginx/error.log`

### Q3: æ–‡ä»¶æƒé™é—®é¢˜ï¼Ÿ

**è§£å†³ï¼š**
```bash
sudo chown -R www-data:www-data /var/www/html/study
sudo chmod -R 755 /var/www/html/study
```

### Q4: HTTPSè¯ä¹¦é—®é¢˜ï¼Ÿ

**æ£€æŸ¥ï¼š**
- è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼š`sudo certbot certificates`
- è¯ä¹¦æ˜¯å¦è¿‡æœŸ
- åŸŸåæ˜¯å¦æ­£ç¡®è§£æ

---

## ğŸ“ å¿«é€Ÿéƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] è™šæ‹Ÿæœºå·²åˆ›å»ºå¹¶å¯åŠ¨
- [ ] å¯ä»¥SSHç™»å½•è™šæ‹Ÿæœº
- [ ] Nginx/Apacheå·²å®‰è£…
- [ ] æ–‡ä»¶å·²ä¸Šä¼ åˆ°è™šæ‹Ÿæœº
- [ ] Nginxé…ç½®å·²åˆ›å»ºå¹¶å¯ç”¨
- [ ] æ–‡ä»¶æƒé™å·²è®¾ç½®
- [ ] å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®
- [ ] HTTPSå·²é…ç½®ï¼ˆPWAå¿…éœ€ï¼‰
- [ ] åœ¨iPadä¸Šå¯ä»¥æ­£å¸¸ä½¿ç”¨

---

## ğŸ’¡ æ¨èæ–¹æ¡ˆ

### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | éš¾åº¦ | åŠŸèƒ½ | æ€§èƒ½ | æ¨èåº¦ |
|------|------|------|------|--------|
| ç®€å•éƒ¨ç½² | â­ | â­â­ | â­â­ | â­â­â­ |
| Dockeréƒ¨ç½² | â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­ |
| **è™šæ‹Ÿæœºéƒ¨ç½²** | â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |

### é€‰æ‹©å»ºè®®

- **ç®€å•ä½¿ç”¨**ï¼šç®€å•éƒ¨ç½²
- **éœ€è¦PWAåŠŸèƒ½**ï¼šDockeréƒ¨ç½²
- **éœ€è¦å®Œæ•´æ§åˆ¶**ï¼šè™šæ‹Ÿæœºéƒ¨ç½²ï¼ˆæ¨èï¼‰

---

## ğŸ¯ æ€»ç»“

ä½¿ç”¨æç©ºé—´è™šæ‹Ÿæœºéƒ¨ç½²çš„ä¼˜åŠ¿ï¼š

1. âœ… **å®Œæ•´åŠŸèƒ½**ï¼šæ”¯æŒæ‰€æœ‰WebæœåŠ¡å™¨åŠŸèƒ½
2. âœ… **æ€§èƒ½ä¼˜ç§€**ï¼šç‹¬ç«‹èµ„æºï¼Œä¸å—é™åˆ¶
3. âœ… **æ˜“äºæ‰©å±•**ï¼šå¯ä»¥å®‰è£…å…¶ä»–æœåŠ¡
4. âœ… **ä¸“ä¸šé…ç½®**ï¼šæ”¯æŒHTTPSã€åŸŸåã€SSLç­‰
5. âœ… **çµæ´»ç®¡ç†**ï¼šSSHç™»å½•ï¼Œå‘½ä»¤è¡Œç®¡ç†

**è™šæ‹Ÿæœºéƒ¨ç½²æ˜¯æœ€ä¸“ä¸šçš„æ–¹æ¡ˆï¼Œé€‚åˆéœ€è¦å®Œæ•´åŠŸèƒ½çš„ç”¨æˆ·ï¼** ğŸš€

